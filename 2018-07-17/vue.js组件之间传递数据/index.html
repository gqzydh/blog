<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="description" content="前端博客">
  <meta name="keywords" content="web前端, Web, 前端开发, 前端博客">
  
    <link rel="icon" href="/images/favicon_32X32.ico">
  
  
  <title>vue.js组件之间传递数据 | 前端博客</title>
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.20/jquery.fancybox.min.css" /> -->
</head>

<body>
  <header>
  <div class="header-nav">
    <div class="header-container">
    <a class='logo' href="/">
      <span>前端博客</span>
    </a>

    <ul class="right-header">
      
        <li class="nav-item">
          
            <a href="/" class="item-link">首页</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/categories" class="item-link">分类</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/archives" class="item-link">归档</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/tags" class="item-link">标签</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/about" class="item-link">关于</a>
          
        </li>
      
    </ul>
  </div>
  </div>

</header>

  <!-- 帖子 -->
<main id='post'>
  <div class="content">
    <article>
        <section class="content markdown-body">
          <h2>vue.js组件之间传递数据</h2>
          <div class='post-meta'>
            <i class="fa fa-calendar" aria-hidden="true"></i> <time>2018_07_17</time>
            
              | <i class="fa fa-folder-open-o" aria-hidden="true"></i> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Vue-js/">Vue.js</a>
  </div>





            
            
              | 
                  <i class="fa fa-tag" aria-hidden="true"></i>
                
               
  <a href="/tags/#Vue.js" class='tag'>Vue.js</a>


            
          </div>
          <p>组件是 vue.js 最强大的功能之一，而组件实例的作用域是相互独立的，这就意味着不同组件之间的数据无法相互引用。如何传递数据也成了组件的重要知识点之一。</p>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p>组件与组件之间，还存在着不同的关系。父子关系与兄弟关系（不是父子的都暂称为兄弟吧）。</p>
<h2 id="父子组件"><a href="#父子组件" class="headerlink" title="父子组件"></a>父子组件</h2><p>示例:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// 注册一个子组件</span><br><span class="line">Vue.component(&apos;child&apos;, &#123;</span><br><span class="line">    data: function()&#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            text: &apos;我是father的子组件！&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    template: &apos;&lt;span&gt;&#123;&#123; text &#125;&#125;&lt;/span&gt;&apos;</span><br><span class="line">&#125;)</span><br><span class="line">// 注册一个父组件</span><br><span class="line">Vue.component(&apos;father&apos;, &#123;</span><br><span class="line">    template: &apos;&lt;div&gt;&lt;child&gt;&lt;/child&gt;&lt;/div&gt;&apos;  // 在模板中使用了child组件</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>直接使用 father 组件的时候：<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;father&gt;&lt;/father&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<p>页面中渲染出 ：我是father的子组件！ </p>
<h2 id="兄弟组件"><a href="#兄弟组件" class="headerlink" title="兄弟组件"></a>兄弟组件</h2><p>两个组件互不引用，则为兄弟组件。<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Vue.component(&apos;brother1&apos;, &#123;</span><br><span class="line">    template: &apos;&lt;div&gt;我是大哥&lt;/div&gt;&apos;</span><br><span class="line">&#125;)</span><br><span class="line">Vue.component(&apos;brother2&apos;, &#123;</span><br><span class="line">    template: &apos;&lt;div&gt;我是小弟&lt;/div&gt;&apos;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>使用组件的时候：<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;brother1&gt;&lt;/brother1&gt;</span><br><span class="line">    &lt;brother2&gt;&lt;/brother2&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<p>页面中渲染出 ：我是大哥/我是小弟</p>
<h2 id="子组件使用父组件的数据-Prop"><a href="#子组件使用父组件的数据-Prop" class="headerlink" title="子组件使用父组件的数据  Prop"></a>子组件使用父组件的数据  Prop</h2><p>示例:<br>在父组件 father.vue 中引用子组件 child.vue，把 name 的值传给 child 子组件。<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">//  这是父组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">        // message 定义在子组件的 props 中</span><br><span class="line">        &lt;child :message=&quot;name&quot;&gt;&lt;/child&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import child from &apos;./child.vue&apos;;</span><br><span class="line">    export default &#123;</span><br><span class="line">        components: &#123;</span><br><span class="line">            child</span><br><span class="line">        &#125;,</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                name: &apos;Aaron&apos;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>在子组件 child.vue 中的 props 选项中声明它获得的数据<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// 这是子组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;span&gt;Hello &#123;&#123;message&#125;&#125;&lt;/span&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        // 在 props 中声明获取父组件的数据通过 message 传过来</span><br><span class="line">        props: [&apos;message&apos;]</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>在子组件页面中就会渲染出：Hello Aaron</p>
<h2 id="单向数据流"><a href="#单向数据流" class="headerlink" title="单向数据流"></a>单向数据流</h2><p>当父组件的 name 发生改变，子组件也会自动地更新视图。但是在子组件中，我们不要去修改 prop。</p>
<p>如果你必须要修改到这些数据，你可以使用以下方法：</p>
<p>方法一：把 prop 赋值给一个局部变量，然后需要修改的话就修改这个局部变量，而不影响 prop<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">    data()&#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            newMessage: null</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;,</span><br><span class="line">    props: [&apos;message&apos;],</span><br><span class="line">    created()&#123;</span><br><span class="line">        this.newMessage = this.message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>方法二：在计算属性中对 prop 进行处理<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">    props: [&apos;message&apos;],</span><br><span class="line">    computed: &#123;</span><br><span class="line">        newMessage()&#123;</span><br><span class="line">            return this.newMessage + &apos; 取个新名字&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="自定义事件"><a href="#自定义事件" class="headerlink" title="自定义事件"></a>自定义事件</h2><p>prop 是单向绑定的：当父组件的属性变化时，将传导给子组件，但是不会反过来。修改子组件的 prop 值，是不会传回给父组件去更新视图的。</p>
<p>那么子组件要如何去与父组件通讯呢？</p>
<p>那就是自定义事件。</p>
<p>通过在父组件 $on(eventName) 监听自定义事件，当子组件里 $emit(eventName) 触发该自定义事件的时候，父组件执行相应的操作。</p>
<p>比如在父组件中控制一个弹框子组件的显示，在子组件中按下关闭之后，告诉父组件去隐藏它，然后父组件就执行操作隐藏弹框。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;app&quot;&gt;</span><br><span class="line">        // hide 为自定义事件，名字可以自己随便起，不能有大写字母，可以使用短横线</span><br><span class="line">        // @hide 监听子组件触发 hide 事件，则会执行 hideDialog 方法</span><br><span class="line">        &lt;dialog :is-show=&quot;show&quot; @hide=&quot;hideDialog&quot;&gt;&lt;/dialog&gt;</span><br><span class="line">        &lt;button @click=&quot;showDialog&quot;&gt;显示弹框&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import dialog from &apos;./dialog.vue&apos;;</span><br><span class="line">    export default &#123;</span><br><span class="line">        components: &#123; dialog &#125;,</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                show: false</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            showDialog() &#123;</span><br><span class="line">                this.show = true;</span><br><span class="line">            &#125;,</span><br><span class="line">            hideDialog() &#123;</span><br><span class="line">                this.show = false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>在子组件 dialog.vue 中：<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;dialog&quot; v-show=&quot;isShow&quot;&gt;</span><br><span class="line">        &lt;p&gt;这里是弹框子组件&lt;/p&gt;</span><br><span class="line">        &lt;button @click=&quot;toHide&quot;&gt;关闭弹框&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        // 驼峰式命名的 prop 需要转换为相对应的短横线隔开式 is-show</span><br><span class="line">        props: [&apos;isShow&apos;],</span><br><span class="line">        methods: &#123;</span><br><span class="line">            toHide()&#123;</span><br><span class="line">                // $emit 方法触发父组件的监听事件</span><br><span class="line">                this.$emit(&apos;hide&apos;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>这样就实现了父子组件之间的相互通讯。</p>
<h2 id="Event-Bus"><a href="#Event-Bus" class="headerlink" title="Event Bus"></a>Event Bus</h2><p>有时候两个组件之间需要进行通信，但是它们彼此不是父子组件的关系。在一些简单场景，你可以使用一个空的 Vue 实例作为一个事件总线中心(central event bus)：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var bus = new Vue();</span><br><span class="line">// 在组件 A 的 methods 方法中触发事件</span><br><span class="line">bus.$emit(&apos;say-hello&apos;, &apos;world&apos;)</span><br><span class="line">// 在组件 B 的 created 钩子函数中监听事件</span><br><span class="line">bus.$on(&apos;say-hello&apos;, function (arg) &#123;</span><br><span class="line">  console.log(&apos;hello &apos; + arg);          // hello world</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h2><p>在复杂场景中，你应该考虑使用专门的状态管理模式 Vuex。<br>(Vuex 英文)[<a href="https://vuex.vuejs.org" target="_blank" rel="noopener">https://vuex.vuejs.org</a>]<br>(Vuex 中文)[<a href="https://vuex.vuejs.org/zh/" target="_blank" rel="noopener">https://vuex.vuejs.org/zh/</a>]</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>组件通讯并不是一定要使用必须要使用 Vuex，对于一些简单的数据传递，event bus 或者 prop 也可以完成。</p>
<ul>
<li>使用 prop 实现子组件的显示与隐藏，</li>
<li>使用 vuex 来实现组件间的数据状态管理。</li>
</ul>

        </section>
    </article>
    
    
        <!-- livere 评论框 start -->
        <div class="comment">
            <div id="lv-container" data-id="city" data-uid="your_livere_uid"></div>
        </div>
        <!-- livere 评论框 end -->
        
  </div>
  <aside>
    
    <div class="toc-container">
        <h2>目录</h2>
        <div class="content">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#组件"><span class="toc-number">1.</span> <span class="toc-text">组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#父子组件"><span class="toc-number">2.</span> <span class="toc-text">父子组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#兄弟组件"><span class="toc-number">3.</span> <span class="toc-text">兄弟组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#子组件使用父组件的数据-Prop"><span class="toc-number">4.</span> <span class="toc-text">子组件使用父组件的数据  Prop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单向数据流"><span class="toc-number">5.</span> <span class="toc-text">单向数据流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自定义事件"><span class="toc-number">6.</span> <span class="toc-text">自定义事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Event-Bus"><span class="toc-number">7.</span> <span class="toc-text">Event Bus</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vuex"><span class="toc-number">8.</span> <span class="toc-text">Vuex</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">9.</span> <span class="toc-text">总结</span></a></li></ol>
        </div>
    </div>
    
  </aside>
</main>


<script type="text/javascript">
  (function(d, s) {
      var j, e = d.getElementsByTagName(s)[0];

      if (typeof LivereTower === 'function') { return; }

      j = d.createElement(s);
      j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
      j.async = true;

      e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>


  <footer id="fooler">
  <div class="copyright">
    <div>
      <span style="padding-right:30px;">
      &copy; 2018 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a>&nbsp
    </span>
      
       本站总访客数 : <span id="busuanzi_value_site_uv"></span>人次 |
       本站总访问量 : <span id="busuanzi_value_site_pv"></span>次
      

    </div>
    <div>
      <!-- Theme by <a href="https://github.com/lewis-geek/hexo-theme-Aath" target="_blank">Aath</a> -->
    </div>
  </div>
</footer>

<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="/lib/in-view.min.js"></script>
<script src="/lib/lodash.min.js"></script>
<script src="/js/script.js"></script>


<script>
  var isDown = true
  var oldY = 0
  inView.offset(50)

  document.body.addEventListener('touchstart', function(){});

  window.addEventListener('scroll', _.throttle(e => {
    var currentY = window.scrollY
    if((oldY - currentY) < 0) {
      isDown = true
    } else {
      isDown = false
    }
    oldY = currentY
  }, 250))

  $("article img").each(function() {
      var strA = "<a data-fancybox='gallery' href='" + this.src + "'></a>";
      $(this).wrapAll(strA);
  });

  $('.toc-link').each(function() {
      var href = $(this).attr("href");

      inView(href).on('exit', () => {
        if (isDown) {
          handleActive(href)
        }
      })

      inView(href).on('enter', () => {
        if (!isDown) {
          handleActive(href)
        }
      })

      this.onclick = function(e) {
        var pos = $(href).offset().top - 10;
        $("html,body").animate({scrollTop: pos}, 300);
        setTimeout(() => {
          handleActive(href)
        }, 350)
        return false
      }
  })

  function handleActive(href) {
    document.querySelectorAll('.toc-link').forEach(elm => {
      elm.classList.remove('active')
    })
    document.querySelector(".toc [href='"+ href +"']").classList.add('active')
  }
</script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.20/jquery.fancybox.min.js"></script> -->



<div class="nodisplay">
<script src="https://s22.cnzz.com/z_stat.php?id=1272859133&web_id=1272859133" language="JavaScript"></script>
</div>



  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



</body>
</html>
