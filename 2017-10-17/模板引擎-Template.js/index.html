<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="description" content="前端博客">
  <meta name="keywords" content="web前端, Web, 前端开发, 前端博客">
  
    <link rel="icon" href="/images/favicon_32X32.ico">
  
  
  <title>Template.js | 前端博客</title>
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.20/jquery.fancybox.min.css" /> -->
</head>

<body>
  <header>
  <div class="header-nav">
    <div class="header-container">
    <a class='logo' href="/">
      <span>前端博客</span>
    </a>

    <ul class="right-header">
      
        <li class="nav-item">
          
            <a href="/" class="item-link">首页</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/categories" class="item-link">分类</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/archives" class="item-link">归档</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/tags" class="item-link">标签</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/about" class="item-link">关于</a>
          
        </li>
      
    </ul>
  </div>
  </div>

</header>

  <!-- 帖子 -->
<main id='post'>
  <div class="content">
    <article>
        <section class="content markdown-body">
          <h2>Template.js</h2>
          <div class='post-meta'>
            <i class="fa fa-calendar" aria-hidden="true"></i> <time>2017_10_17</time>
            
              | <i class="fa fa-folder-open-o" aria-hidden="true"></i> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/模板引擎/">模板引擎</a>
  </div>





            
            
              | 
                  <i class="fa fa-tag" aria-hidden="true"></i>
                
               
  <a href="/tags/#Template.js" class='tag'>Template.js</a>


            
          </div>
          <p>Template.js 一款 JavaScript 模板引擎，简单，好用。提供一套模板语法，用户可以写一个模板区块，每次根据传入的数据，生成对应数据产生的HTML片段，渲染不同的效果。<a href="https://github.com/aui/artTemplate" target="_blank" rel="noopener">https://github.com/aui/artTemplate</a></p>
<h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><p>（1）、性能卓越，执行速度通常是 Mustache 与 tmpl 的 20 多倍（性能测试）（2）、支持运行时调试，可精确定位异常模板所在语句（演示）</p>
<p>（3）、对 NodeJS Express 友好支持（4）、安全，默认对输出进行转义、在沙箱中运行编译后的代码（Node版本可以安全执行用户上传的模板）</p>
<p>（5）、支持include语句</p>
<p>（6）、可在浏览器端实现按路径加载模板（详情）</p>
<p>（7）、支持预编译，可将模板转换成为非常精简的 js 文件</p>
<p>（8）、模板语句简洁，无需前缀引用数据，有简洁版本与原生语法版本可选</p>
<p>（9）、支持所有流行的浏览器</p>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p>（1）、使用<br>引用简洁语法的引擎版本，例如： <code>&lt;script src=&quot;dist/template.js&quot;&gt;&lt;/script&gt;</code> </p>
<p>（2）、表达式<br> 符号包裹起来的语句则为模板的逻辑表达式。</p>
<p>（3）、输出表达式<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;content&#125;&#125;  //对内容编码输出</span><br><span class="line">&#123;&#123;#content&#125;&#125;  //不编码输出</span><br></pre></td></tr></table></figure></p>
<p>编码可以防止数据中含有 HTML 字符串，避免引起 XSS 攻击。</p>
<p>（4）、条件表达式<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;if admin&#125;&#125;</span><br><span class="line"> &lt;p&gt;admin&lt;/p&gt;</span><br><span class="line">&#123;&#123;else if code &gt; 0&#125;&#125;</span><br><span class="line"> &lt;p&gt;master&lt;/p&gt;</span><br><span class="line">&#123;&#123;else&#125;&#125;</span><br><span class="line"> &lt;p&gt;error!&lt;/p&gt;</span><br><span class="line">&#123;&#123;/if&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>（5）、遍历表达式<br>无论数组或者对象都可以用 each 进行遍历。<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;each list as value index&#125;&#125;</span><br><span class="line"> &lt;li&gt;&#123;&#123;index&#125;&#125; - &#123;&#123;value.user&#125;&#125;&lt;/li&gt;</span><br><span class="line">&#123;&#123;/each&#125;&#125;</span><br><span class="line">===亦可以被简写：</span><br><span class="line">&#123;&#123;each list&#125;&#125;</span><br><span class="line"> &lt;li&gt;&#123;&#123;$index&#125;&#125; - &#123;&#123;$value.user&#125;&#125;&lt;/li&gt;</span><br><span class="line">&#123;&#123;/each&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>（6）、模板包含表达式</p>
<p>用于嵌入子模板。<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;include &apos;template_name&apos;&#125;&#125;  </span><br><span class="line">子模板默认共享当前数据，亦可以指定数据：&#123;&#123;include &apos;template_name&apos; news_list&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>（7）、辅助方法</p>
<p>使用template.helper(name, callback)注册公用辅助方法<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template.helper(&apos;dateFormat&apos;, function (date, format) &#123;</span><br><span class="line"> // ……</span><br><span class="line"> return value;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;time | dateFormat:&apos;yyyy-MM-dd hh:mm:ss&apos;&#125;&#125;  //模板中使用的方式</span><br><span class="line">&#123;&#123;time | say:&apos;cd&apos; | ubb | link&#125;&#125;  //支持传入参数与嵌套使用</span><br></pre></td></tr></table></figure>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>实例-01<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=&quot;content&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;script id=&quot;test&quot; type=&quot;text/html&quot;&gt;</span><br><span class="line">&#123;&#123;if isAdmin&#125;&#125;</span><br><span class="line">&lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line"> &#123;&#123;each list as value i&#125;&#125;</span><br><span class="line">  &lt;li&gt;索引 &#123;&#123;i + 1&#125;&#125; ：&#123;&#123;value&#125;&#125;&lt;/li&gt;</span><br><span class="line"> &#123;&#123;/each&#125;&#125;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&#123;&#123;/if&#125;&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var data = &#123;</span><br><span class="line"> title: &apos;基本例子&apos;,</span><br><span class="line"> isAdmin: true,</span><br><span class="line"> list: [&apos;文艺&apos;, &apos;博客&apos;, &apos;摄影&apos;, &apos;电影&apos;, &apos;民谣&apos;, &apos;旅行&apos;, &apos;吉他&apos;]</span><br><span class="line">&#125;;</span><br><span class="line">var html = template(&apos;test&apos;, data);</span><br><span class="line">document.getElementById(&apos;content&apos;).innerHTML = html;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure></p>
<p>实例-02<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"> &lt;h1&gt;不转义HTML&lt;/h1&gt;</span><br><span class="line"> &lt;div id=&quot;content&quot;&gt;&lt;/div&gt;</span><br><span class="line"> &lt;script id=&quot;test&quot; type=&quot;text/html&quot;&gt;</span><br><span class="line"> &lt;p&gt;不转义：&#123;&#123;#value&#125;&#125;&lt;/p&gt;</span><br><span class="line"> &lt;p&gt;默认转义： &#123;&#123;value&#125;&#125;&lt;/p&gt;</span><br><span class="line"> &lt;/script&gt;</span><br><span class="line">  </span><br><span class="line"> &lt;script&gt;</span><br><span class="line"> var data = &#123;</span><br><span class="line">  value: &apos;&lt;span style=&quot;color:#F00&quot;&gt;hello world!&lt;/span&gt;&apos;</span><br><span class="line"> &#125;;</span><br><span class="line"> var html = template(&apos;test&apos;, data);</span><br><span class="line"> document.getElementById(&apos;content&apos;).innerHTML = html;</span><br><span class="line"> &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure></p>
<p>实例-03<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE HTML&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;helper-demo&lt;/title&gt;</span><br><span class="line">&lt;script src=&quot;../dist/template.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">  </span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;辅助方法&lt;/h1&gt;</span><br><span class="line">&lt;div id=&quot;content&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;script id=&quot;test&quot; type=&quot;text/html&quot;&gt;</span><br><span class="line">&#123;&#123;time | dateFormat:&apos;yyyy年 MM月 dd日 hh:mm:ss&apos;&#125;&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">  </span><br><span class="line">&lt;script&gt;</span><br><span class="line">/**</span><br><span class="line"> * 对日期进行格式化，</span><br><span class="line"> * @param date 要格式化的日期</span><br><span class="line"> * @param format 进行格式化的模式字符串</span><br><span class="line"> *  支持的模式字母有：</span><br><span class="line"> *  y:年,</span><br><span class="line"> *  M:年中的月份(1-12),</span><br><span class="line"> *  d:月份中的天(1-31),</span><br><span class="line"> *  h:小时(0-23),</span><br><span class="line"> *  m:分(0-59),</span><br><span class="line"> *  s:秒(0-59),</span><br><span class="line"> *  S:毫秒(0-999),</span><br><span class="line"> *  q:季度(1-4)</span><br><span class="line"> * @return String</span><br><span class="line"> * @author yanis.wang</span><br><span class="line"> * @see http://yaniswang.com/frontend/2013/02/16/dateformat-performance/</span><br><span class="line"> */</span><br><span class="line">template.helper(&apos;dateFormat&apos;, function (date, format) &#123;</span><br><span class="line">  </span><br><span class="line"> if (typeof date === &quot;string&quot;) &#123;</span><br><span class="line">  var mts = date.match(/(\/Date(\d+)\/)/);</span><br><span class="line">  if (mts &amp;&amp; mts.length &gt;= 3) &#123;</span><br><span class="line">   date = parseInt(mts[2]);</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> date = new Date(date);</span><br><span class="line"> if (!date || date.toUTCString() == &quot;Invalid Date&quot;) &#123;</span><br><span class="line">  return &quot;&quot;;</span><br><span class="line"> &#125;</span><br><span class="line">  </span><br><span class="line"> var map = &#123;</span><br><span class="line">  &quot;M&quot;: date.getMonth() + 1, //月份</span><br><span class="line">  &quot;d&quot;: date.getDate(), //日</span><br><span class="line">  &quot;h&quot;: date.getHours(), //小时</span><br><span class="line">  &quot;m&quot;: date.getMinutes(), //分</span><br><span class="line">  &quot;s&quot;: date.getSeconds(), //秒</span><br><span class="line">  &quot;q&quot;: Math.floor((date.getMonth() + 3) / 3), //季度</span><br><span class="line">  &quot;S&quot;: date.getMilliseconds() //毫秒</span><br><span class="line"> &#125;;</span><br><span class="line">   </span><br><span class="line">  </span><br><span class="line"> format = format.replace(/([yMdhmsqS])+/g, function(all, t)&#123;</span><br><span class="line">  var v = map[t];</span><br><span class="line">  if(v !== undefined)&#123;</span><br><span class="line">   if(all.length &gt; 1)&#123;</span><br><span class="line">    v = &apos;0&apos; + v;</span><br><span class="line">    v = v.substr(v.length-2);</span><br><span class="line">   &#125;</span><br><span class="line">   return v;</span><br><span class="line">  &#125;</span><br><span class="line">  else if(t === &apos;y&apos;)&#123;</span><br><span class="line">   return (date.getFullYear() + &apos;&apos;).substr(4 - all.length);</span><br><span class="line">  &#125;</span><br><span class="line">  return all;</span><br><span class="line"> &#125;);</span><br><span class="line"> return format;</span><br><span class="line">&#125;);</span><br><span class="line">  </span><br><span class="line">// --------</span><br><span class="line">  </span><br><span class="line">var data = &#123;</span><br><span class="line"> time: 1408536771253,</span><br><span class="line">&#125;;</span><br><span class="line">var html = template(&apos;test&apos;, data);</span><br><span class="line">document.getElementById(&apos;content&apos;).innerHTML = html;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="常用语法"><a href="#常用语法" class="headerlink" title="常用语法."></a>常用语法.</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;# print(self.makeexpect.expect); #&gt;万  //输出金额</span><br><span class="line"></span><br><span class="line">// if 判断</span><br><span class="line">&lt;#if(self.makeexpect.description == 1)&#123;#&gt;</span><br><span class="line">&lt;div class=&quot;tenprizeimg&quot;&gt;&lt;img src=&quot;/static/img/mystory/img1.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;#&#125;#&gt;</span><br><span class="line">&lt;#if(self.makeexpect.description == 2)&#123;#&gt;</span><br><span class="line">&lt;div class=&quot;tenprizeimg&quot;&gt;&lt;img src=&quot;/static/img/mystory/img2.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;#&#125;#&gt;</span><br><span class="line">&lt;#if(self.makeexpect.description == 3)&#123;#&gt;</span><br><span class="line">&lt;div class=&quot;tenprizeimg&quot;&gt;&lt;img src=&quot;/static/img/mystory/img3.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;#&#125;#&gt;</span><br></pre></td></tr></table></figure>
        </section>
    </article>
    
    
        <!-- livere 评论框 start -->
        <div class="comment">
            <div id="lv-container" data-id="city" data-uid="your_livere_uid"></div>
        </div>
        <!-- livere 评论框 end -->
        
  </div>
  <aside>
    
    <div class="toc-container">
        <h2>目录</h2>
        <div class="content">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#特性"><span class="toc-number">1.</span> <span class="toc-text">特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#语法"><span class="toc-number">2.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实例"><span class="toc-number">3.</span> <span class="toc-text">实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常用语法"><span class="toc-number">4.</span> <span class="toc-text">常用语法.</span></a></li></ol>
        </div>
    </div>
    
  </aside>
</main>


<script type="text/javascript">
  (function(d, s) {
      var j, e = d.getElementsByTagName(s)[0];

      if (typeof LivereTower === 'function') { return; }

      j = d.createElement(s);
      j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
      j.async = true;

      e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>


  <footer id="fooler">
  <div class="copyright">
    <div>
      <span style="padding-right:30px;">
      &copy; 2018 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a>&nbsp
    </span>
      
       本站总访客数 : <span id="busuanzi_value_site_uv"></span>人次 |
       本站总访问量 : <span id="busuanzi_value_site_pv"></span>次
      

    </div>
    <div>
      <!-- Theme by <a href="https://github.com/lewis-geek/hexo-theme-Aath" target="_blank">Aath</a> -->
    </div>
  </div>
</footer>

<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="/lib/in-view.min.js"></script>
<script src="/lib/lodash.min.js"></script>
<script src="/js/script.js"></script>


<script>
  var isDown = true
  var oldY = 0
  inView.offset(50)

  document.body.addEventListener('touchstart', function(){});

  window.addEventListener('scroll', _.throttle(e => {
    var currentY = window.scrollY
    if((oldY - currentY) < 0) {
      isDown = true
    } else {
      isDown = false
    }
    oldY = currentY
  }, 250))

  $("article img").each(function() {
      var strA = "<a data-fancybox='gallery' href='" + this.src + "'></a>";
      $(this).wrapAll(strA);
  });

  $('.toc-link').each(function() {
      var href = $(this).attr("href");

      inView(href).on('exit', () => {
        if (isDown) {
          handleActive(href)
        }
      })

      inView(href).on('enter', () => {
        if (!isDown) {
          handleActive(href)
        }
      })

      this.onclick = function(e) {
        var pos = $(href).offset().top - 10;
        $("html,body").animate({scrollTop: pos}, 300);
        setTimeout(() => {
          handleActive(href)
        }, 350)
        return false
      }
  })

  function handleActive(href) {
    document.querySelectorAll('.toc-link').forEach(elm => {
      elm.classList.remove('active')
    })
    document.querySelector(".toc [href='"+ href +"']").classList.add('active')
  }
</script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.20/jquery.fancybox.min.js"></script> -->



<div class="nodisplay">
<script src="https://s22.cnzz.com/z_stat.php?id=1272859133&web_id=1272859133" language="JavaScript"></script>
</div>



  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



</body>
</html>
